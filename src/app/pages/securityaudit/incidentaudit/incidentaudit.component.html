<div class="incidentaudit_content">
    <!-- 右上角操作事件 -->
    <div class="top-left">
        <span class="circle"></span>
        <span>发现新事件，可以<u><i nz-icon nzType="sync" nzTheme="outline"></i>刷新</u>查看</span>
    </div>
    <div class="top-right">
        <button nz-button nzType="primary" class="mr-10" routerLink="./analysis">
            <i nz-icon nzType="area-chart" nzTheme="outline" style="font-size: 18px"></i>事件统计分析
        </button>
        <button nz-button nzType="primary" class="mr-10">
            <i nz-icon nzType="sync" nzTheme="outline"></i>刷新
        </button>
        <button nz-button nzType="primary" (click)="clearAllData()">清空全部事件</button>
        <app-modal [isVisible]="isVisible"
                   (closeModal)="closeModal($event)"
                   [message_content]="'清空全部事件可能需要较长时间'"
                   [message_content_tip]="'您还要继续吗?'">
        </app-modal>
    </div>
    <!-- 过滤条件 -->
    <app-filter-table [timeValueData]="filterConditionData.timeValueData"
                      [controlArray]="filterConditionData.controlArray"
                      [showTimePicker]="true"
                      [isFuzzySearch]="true"
                      (searchFilterTable)="searchFilterTable($event)">
    </app-filter-table>
    <div class="dataSummary mb-20">
        <div *ngFor="let item of dataSummary" class="inline-block">
            <span>{{item.name}}：</span>
            <span class="count" [ngStyle]="{'color': item.color}">{{item.count}}</span>
        </div>
    </div>
    <div class="mb-10">
        <nz-dropdown [nzTrigger]="'click'">
            <button nz-button nz-dropdown nzType="primary" class="mr-10">
                <span>操作全部</span>
                <i nz-icon type="down" class="fr" style="line-height: 20px; margin-left: 0"></i>
            </button>
            <ul nz-menu>
                <li nz-menu-item>导出全部</li>
                <li nz-menu-item>清空全部</li>
            </ul>
        </nz-dropdown>
        <button nz-button nzType="primary" class="mr-10">清空</button>
        <button nz-button nzType="primary" class="mr-10"><i nz-icon nzType="download" nzTheme="outline"></i>导出</button>
    </div>
    <!-- 表格 -->
    <nz-table #tableDataTmp
              [nzData]="tableData"
              [nzTotal]="tableCount"
              [nzShowQuickJumper]="true"
              [nzFrontPagination]="false"
              [(nzPageIndex)]="pageIndex"
              [(nzPageSize)]="pageSize"
              (nzPageIndexChange)="pageIndexChange()"
              [nzLoading]="loading"
              [nzShowTotal]="totalTemplate">
        <thead>
            <tr>
                <th nzShowCheckbox [(nzChecked)]="allChecked" (nzCheckedChange)="checkAll($event)"></th>
                <th>事件名称</th>
                <th>应用协议</th>
                <th>安全域</th>
                <th>规则来源</th>
                <th>源IP</th>
                <th>目的IP</th>
                <th>时间</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let item of tableDataTmp.data" (click)="clickIncRow(item)">
                <td nzShowCheckbox [(nzChecked)]="item.checked" (nzCheckedChange)="refreshStatus()"></td>
                <td>{{item.name}}</td>
                <td>{{item.protocol}}</td>
                <td>{{item.securityAreaName}}</td>
                <td>{{item.typeDisplay}}</td>
                <td>{{item.sourceIP}}</td>
                <td>{{item.destinationIp}}</td>
                <td>{{item.date | date: 'yyyy-MM-dd HH:mm:ss'}}</td>
                <td routerLink="./detail/1"><i nz-icon nzType="search" nzTheme="outline"></i>详情</td>
            </tr>
        </tbody>
    </nz-table>
    <ng-template #totalTemplate let-total>
        <span>共 {{tableCount}} 条，</span>
        <span>每页展示 {{pageSize}} 条，</span>
        <span>共 {{pageTotalNumber}} 页</span>
    </ng-template>
</div>
